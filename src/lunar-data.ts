const LUN_TABLE = [
  /*        1   2   3   4   5   6   7   8   9   10  11  12  윤  윤달크기 */
  /*1890*/ [29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 2, 29],
  /*1891*/ [29, 30, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1892*/ [29, 29, 30, 29, 29, 30, 30, 30, 29, 30, 30, 30, 6, 29],
  /*1893*/ [29, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 0, 0],
  /*1894*/ [29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 0, 0],
  /*1895*/ [30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 5, 29],
  /*1896*/ [30, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1897*/ [29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1898*/ [30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 30, 29, 3, 29],
  /*1899*/ [30, 29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 0, 0],
  /*1900*/ [29, 30, 29, 29, 30, 29, 30, 30, 30, 30, 29, 30, 8, 29],
  /*1901*/ [29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*1902*/ [30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 0, 0],
  /*1903*/ [29, 30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 5, 29],
  /*1904*/ [30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 0, 0],
  /*1905*/ [30, 30, 29, 30, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1906*/ [29, 30, 30, 29, 29, 30, 29, 30, 29, 30, 29, 30, 4, 30],
  /*1907*/ [29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1908*/ [30, 29, 29, 30, 30, 29, 30, 29, 30, 30, 29, 30, 0, 0],
  /*1909*/ [29, 30, 29, 30, 29, 30, 29, 30, 30, 30, 29, 30, 2, 29],
  /*1910*/ [29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*1911*/ [30, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 6, 29],
  /*1912*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 0, 0],
  /*1913*/ [30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*1914*/ [30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 5, 29],
  /*1915*/ [30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1916*/ [29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1917*/ [30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 2, 29],
  /*1918*/ [30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 30, 0, 0],
  /*1919*/ [29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 30, 7, 29],
  /*1920*/ [29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1921*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 0, 0],
  /*1922*/ [30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 30, 5, 29],
  /*1923*/ [29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 30, 0, 0],
  /*1924*/ [30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 29, 0, 0],
  /*1925*/ [30, 29, 30, 30, 30, 29, 30, 30, 29, 30, 29, 30, 4, 29],
  /*1926*/ [29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*1927*/ [30, 29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1928*/ [29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 30, 30, 2, 29],
  /*1929*/ [29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 0, 0],
  /*1930*/ [29, 30, 30, 29, 29, 30, 29, 30, 29, 30, 30, 29, 6, 29],
  /*1931*/ [30, 30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 29, 0, 0],
  /*1932*/ [30, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*1933*/ [29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 30, 5, 30],
  /*1934*/ [29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 0, 0],
  /*1935*/ [29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*1936*/ [30, 29, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 3, 30],
  /*1937*/ [30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*1938*/ [30, 30, 29, 29, 30, 29, 29, 29, 30, 30, 29, 30, 7, 30],
  /*1939*/ [30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1940*/ [30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 0, 0],
  /*1941*/ [30, 30, 29, 30, 30, 29, 29, 29, 30, 29, 30, 29, 6, 30],
  /*1942*/ [30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 0, 0],
  /*1943*/ [29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 0, 0],
  /*1944*/ [29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 4, 30],
  /*1945*/ [29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 0, 0],
  /*1946*/ [30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 0, 0],
  /*1947*/ [30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 2, 29],
  /*1948*/ [30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1949*/ [30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 7, 29],
  /*1950*/ [30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 0, 0],
  /*1951*/ [30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1952*/ [29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 5, 30],
  /*1953*/ [29, 30, 29, 29, 30, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1954*/ [29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1955*/ [30, 29, 29, 29, 29, 30, 29, 30, 29, 30, 30, 30, 3, 30],
  /*1956*/ [29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 0, 0],
  /*1957*/ [30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 30, 8, 29],
  /*1958*/ [29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1959*/ [29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1960*/ [30, 29, 30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 6, 29],
  /*1961*/ [30, 29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 0, 0],
  /*1962*/ [29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*1963*/ [30, 29, 30, 29, 30, 29, 30, 29, 30, 30, 30, 29, 4, 29],
  /*1964*/ [30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 0, 0],
  /*1965*/ [29, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 30, 0, 0],
  /*1966*/ [29, 30, 30, 30, 29, 29, 30, 29, 29, 30, 30, 29, 3, 29],
  /*1967*/ [30, 30, 29, 30, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*1968*/ [29, 30, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 7, 29],
  /*1969*/ [29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1970*/ [30, 29, 29, 30, 30, 29, 30, 29, 30, 30, 29, 30, 0, 0],
  /*1971*/ [29, 30, 29, 29, 30, 30, 29, 30, 30, 30, 29, 30, 5, 29],
  /*1972*/ [29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*1973*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 30, 29, 0, 0],
  /*1974*/ [30, 30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 4, 29],
  /*1975*/ [30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*1976*/ [30, 30, 29, 30, 29, 30, 29, 30, 30, 29, 29, 30, 8, 29],
  /*1977*/ [30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 0, 0],
  /*1978*/ [30, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 0, 0],
  /*1979*/ [30, 29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 29, 6, 30],
  /*1980*/ [30, 29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1981*/ [29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1982*/ [30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 30, 30, 4, 29],
  /*1983*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 0, 0],
  /*1984*/ [30, 29, 30, 30, 29, 29, 30, 29, 29, 30, 30, 30, 10, 29],
  /*1985*/ [29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*1986*/ [29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 29, 0, 0],
  /*1987*/ [30, 29, 30, 30, 29, 30, 30, 30, 29, 30, 29, 30, 6, 29],
  /*1988*/ [29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*1989*/ [30, 29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*1990*/ [29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 30, 5, 29],
  /*1991*/ [29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 0, 0],
  /*1992*/ [29, 30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 0, 0],
  /*1993*/ [29, 30, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 3, 29],
  /*1994*/ [30, 30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*1995*/ [29, 30, 30, 29, 30, 30, 29, 30, 30, 29, 29, 30, 8, 29],
  /*1996*/ [29, 30, 29, 30, 30, 29, 30, 29, 30, 30, 29, 30, 0, 0],
  /*1997*/ [29, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*1998*/ [30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 30, 29, 5, 29],
  /*1999*/ [30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*2000*/ [30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 0, 0],
  /*2001*/ [30, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 4, 29],
  /*2002*/ [30, 30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 0, 0],
  /*2003*/ [30, 30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*2004*/ [29, 30, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 2, 29],
  /*2005*/ [29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 29, 0, 0],
  /*2006*/ [30, 29, 30, 29, 30, 29, 30, 30, 30, 29, 30, 30, 7, 29],
  /*2007*/ [29, 29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 0, 0],
  /*2008*/ [30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 0, 0],
  /*2009*/ [30, 30, 29, 29, 30, 29, 30, 29, 30, 29, 30, 30, 5, 29],
  /*2010*/ [30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*2011*/ [30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 0, 0],
  /*2012*/ [30, 29, 30, 30, 29, 30, 29, 29, 30, 29, 30, 29, 3, 30],
  /*2013*/ [30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 0, 0],
  /*2014*/ [29, 30, 29, 30, 29, 30, 29, 30, 30, 30, 29, 30, 9, 29],
  /*2015*/ [29, 30, 29, 29, 30, 29, 30, 30, 30, 29, 30, 29, 0, 0],
  /*2016*/ [30, 29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 0, 0],
  /*2017*/ [29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 30, 30, 5, 29],
  /*2018*/ [29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 0, 0],
  /*2019*/ [30, 29, 30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 0, 0],
  /*2020*/ [30, 29, 30, 30, 30, 29, 29, 30, 29, 30, 29, 30, 4, 29],
  /*2021*/ [29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 0, 0],
  /*2022*/ [30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 0, 0],
  /*2023*/ [29, 30, 30, 29, 30, 29, 30, 30, 29, 30, 29, 30, 2, 29],
  /*2024*/ [29, 30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 29, 0, 0],
  /*2025*/ [30, 29, 30, 29, 29, 30, 30, 29, 30, 30, 30, 29, 6, 29],
  /*2026*/ [30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 0, 0],
  /*2027*/ [29, 30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 30, 0, 0],
  /*2028*/ [29, 30, 30, 29, 30, 29, 30, 29, 29, 30, 30, 29, 5, 29],
  /*2029*/ [30, 30, 29, 30, 30, 29, 29, 30, 29, 29, 30, 30, 0, 0],
  /*2030*/ [29, 30, 29, 30, 30, 29, 30, 29, 30, 29, 30, 29, 0, 0],
  /*2031*/ [30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 3, 29],
  /*2032*/ [30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 0, 0],
  /*2033*/ [29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 30, 11, 29],
  /*2034*/ [29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 29, 0, 0],
  /*2035*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 0, 0],
  /*2036*/ [30, 30, 29, 30, 29, 29, 29, 29, 30, 30, 29, 30, 6, 30],
  /*2037*/ [30, 30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*2038*/ [30, 30, 29, 30, 29, 30, 29, 30, 29, 29, 30, 29, 0, 0],
  /*2039*/ [30, 30, 29, 30, 30, 30, 29, 30, 29, 30, 29, 29, 5, 29],
  /*2040*/ [30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 0, 0],
  /*2041*/ [30, 29, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 0, 0],
  /*2042*/ [29, 30, 29, 30, 29, 30, 29, 30, 30, 29, 30, 30, 2, 29],
  /*2043*/ [29, 30, 29, 29, 30, 29, 29, 30, 30, 29, 30, 30, 0, 0],
  /*2044*/ [30, 29, 30, 29, 29, 30, 29, 30, 29, 30, 30, 30, 7, 29],
  /*2045*/ [30, 29, 30, 29, 29, 30, 29, 29, 30, 29, 30, 30, 0, 0],
  /*2046*/ [30, 29, 30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 0, 0],
  /*2047*/ [30, 29, 30, 30, 29, 29, 30, 29, 29, 30, 29, 30, 5, 30],
  /*2048*/ [29, 30, 30, 29, 30, 30, 29, 30, 29, 30, 29, 29, 0, 0],
  /*2049*/ [30, 29, 30, 29, 30, 30, 29, 30, 30, 29, 30, 29, 0, 0],
];

const BASE_YEAR = 1890;
const BASE_MONTH = 1;
const BASE_DAY = 1;

const MAX_YEAR = 2049;
const MAX_MONTH = 12;
const MAX_DAY = 29;

const getYearData = (year: number): number[] => {
  return LUN_TABLE[year - BASE_YEAR];
};

const getMonthDays = (year: number, month: number): number => {
  return getYearData(year)[month - 1];
};

const getLeapMonth = (year: number): number => {
  return getYearData(year)[12];
};

const hasLeapMonth = (year: number): boolean => {
  return getLeapMonth(year) !== 0;
};

const isLeapMonth = (year: number, month: number): boolean => {
  return month === getLeapMonth(year);
};

const getLeapMonthDays = (year: number, month: number): number => {
  return getYearData(year)[13];
};

const getYearDays = (year: number): number => {
  const yData = getYearData(year);
  let days = 0;
  for (let m = 0; m < 12; m++) {
    days += yData[m];
  }
  const leapMonth = getLeapMonth(year);
  if (leapMonth !== 0) {
    days += getLeapMonthDays(year, leapMonth);
  }
  return days;
};

const getTotalDaysBeforeYear = (year: number): number => {
  let days = 0;
  for (let y = BASE_YEAR; y < year; y++) {
    days += getYearDays(y);
  }
  return days;
};

const getTotalDaysBeforeMonth = (year: number, month: number, isLeapMonth: boolean): number => {
  let days = 0;
  // 해당 월 전까지 윤달을 포함하여 누적
  for (let m = 1; m < month; m++) {
    days += getMonthDays(year, m);
    if (m === getLeapMonth(year)) {
      days += getLeapMonthDays(year, m);
    }
  }
  // 대상이 윤달이면, 앞에 있는 평달을 누적
  let leapMonth = getLeapMonth(year);
  if (isLeapMonth && leapMonth === month) {
    days += getMonthDays(year, month);
  }
  return days;
};

const getTotalDays = (year: number, month: number, day: number, isLeapMonth: boolean): number => {
  let days = getTotalDaysBeforeYear(year) + getTotalDaysBeforeMonth(year, month, isLeapMonth) + day;
  return days;
};

export const LunarData = {
  BASE_YEAR,
  BASE_MONTH,
  BASE_DAY,
  MAX_YEAR,
  MAX_MONTH,
  MAX_DAY,
  getMonthDays,
  getLeapMonth,
  hasLeapMonth,
  isLeapMonth,
  getLeapMonthDays,
  getYearDays,
  getTotalDaysBeforeYear,
  getTotalDaysBeforeMonth,
  getTotalDays,
};
